<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"gaochangyu.github.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="麦田博客">
<meta property="og:url" content="http://gaochangyu.github.com/index.html">
<meta property="og:site_name" content="麦田博客">
<meta property="og:locale">
<meta property="article:author" content="常宇">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://gaochangyu.github.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh'
  };
</script>

  <title>麦田博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">麦田博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="http://gaochangyu.github.com/2021/04/09/%E9%85%8D%E7%BD%AEgit%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%BE%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="常宇">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="麦田博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/%E9%85%8D%E7%BD%AEgit%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%BE%E7%BD%AE/" class="post-title-link" itemprop="url">配置git代理服务器设置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-04-09 17:41:15 / Modified: 17:46:28" itemprop="dateCreated datePublished" datetime="2021-04-09T17:41:15+08:00">2021-04-09</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2021/04/09/%E9%85%8D%E7%BD%AEgit%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%BE%E7%BD%AE/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/04/09/配置git代理服务器设置/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>git不会读取和使用环境变量中的http_proxy和https_proxy来配置代理服务器，因此需要使用额外的git配置启用代理服务器。具体配置如下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy http:&#x2F;&#x2F;&#123;ip&#125;:&#123;port&#125;</span><br><span class="line">git config --global https.proxy http:&#x2F;&#x2F;&#123;ip&#125;:&#123;port&#125;</span><br><span class="line">git config --global https.sslVerify false</span><br></pre></td></tr></table></figure>
<p>第3行可以关掉ssl验证，在遇到证书问题时很有用。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="http://gaochangyu.github.com/2021/04/09/%E5%9C%A8docker-build%E6%97%B6%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="常宇">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="麦田博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/%E5%9C%A8docker-build%E6%97%B6%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8/" class="post-title-link" itemprop="url">在docker build时使用代理服务器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-09 15:32:58" itemprop="dateCreated datePublished" datetime="2021-04-09T15:32:58+08:00">2021-04-09</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2021/04/09/%E5%9C%A8docker-build%E6%97%B6%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/04/09/在docker-build时使用代理服务器/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在企业代理服务器之后使用docker时，需要配置代理服务器才能连接网络。然而，在docker desktop中配置了代理服务器，在docker build时却不生效。经过一番资料查阅，发现正确的方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build --build-args http_proxy&#x3D;http:&#x2F;&#x2F;&#123;ip_addr&#125;:&#123;port&#125; --build-args https_proxy&#x3D;http:&#x2F;&#x2F;&#123;ip_addr&#125;:&#123;port&#125; .</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="http://gaochangyu.github.com/2021/04/03/%E4%BD%BF%E7%94%A8laszip%E5%8E%8B%E7%BC%A9%E6%BF%80%E5%85%89%E7%82%B9%E4%BA%91%E6%95%B0%E6%8D%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="常宇">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="麦田博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/03/%E4%BD%BF%E7%94%A8laszip%E5%8E%8B%E7%BC%A9%E6%BF%80%E5%85%89%E7%82%B9%E4%BA%91%E6%95%B0%E6%8D%AE/" class="post-title-link" itemprop="url">使用laszip压缩激光点云数据</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-03 16:43:22" itemprop="dateCreated datePublished" datetime="2021-04-03T16:43:22+08:00">2021-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-07 11:26:35" itemprop="dateModified" datetime="2021-04-07T11:26:35+08:00">2021-04-07</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2021/04/03/%E4%BD%BF%E7%94%A8laszip%E5%8E%8B%E7%BC%A9%E6%BF%80%E5%85%89%E7%82%B9%E4%BA%91%E6%95%B0%E6%8D%AE/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/04/03/使用laszip压缩激光点云数据/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>LAS是一种用于交换和存储激光点云数据的二进制数据格式。该格式由美国摄影测量与遥感学会(ASPRS)设计，在2003年发布了最初版本。该格式已经成为激光数据的事实标准。然而，LAS格式没有对数据进行任何压缩，所以文件大小通常都很大。</p>
<p><a target="_blank" rel="noopener" href="http://rapidlasso.com/">rapidlasso Gmbh.公司</a>设计了LASzip，用于对LAS文件进行压缩，显著减小文件体积，压缩后的文件体积通常只有LAS文件的7%到20%。LASzip所使用的压缩算法不包含任何专利限制，软件使用LGPL license，易于集成，成为了LAS文件压缩的标准方法。</p>
<p>随着激光雷达设备在遥感，个人娱乐终端，自动驾驶等领域的应用，激光点云数据集数据量不断激增。在过去十年，激光点云压缩成为了产业界的研发热点。针对AR/VR娱乐领域，MPEG在2020年初推出了V-PCC和G-PCC两种压缩标准（<a target="_blank" rel="noopener" href="https://mpeg-pcc.org/">链接</a>）。谷歌针对点云网络传输的需求，推出了<a target="_blank" rel="noopener" href="https://github.com/google/draco">Draco</a>。在自动驾驶领域，多篇学术文章探讨了针对车载激光雷达特点的点云压缩算法(<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2008.06972">Yu Feng et al. 2020</a>)。在遥感和地图领域，LAS的互交换性得到广泛的认可，在多种GIS软件和地图服务器中兼容性好，并且具有较高的压缩率，因此适用于在高精地图和众包地图应用中使用。</p>
<h2 id="LASzip简介"><a href="#LASzip简介" class="headerlink" title="LASzip简介"></a>LASzip简介</h2><p>在介绍LASzip之前，先了解一下LAS点云文件。<br>LAS文件目前共有v1.0到v1.4数个版本，本文以最新的v1.4版本为例，LAS文件由文件头和数据记录组成，并且包含可选的可变长度记录（VLR）和扩展可变长度记录（EVLR）。</p>
<ul>
<li>文件头： 文件头包含文件版本，文件头长度等必要元信息；</li>
<li>数据记录：文件标准要求统一使用小端顺序存储LAS数据记录。v1.4一共支持11种点数据格式，包含点云数据格式0 ～ 11。</li>
<li>VLR：在文件头之后可以包含可选的VLR数据，VLR数据包含参考坐标系信息，元信息，额外数据定义，或者其他用户自定义的信息。所有VLR的长度不超过65535字节。</li>
<li>EVLR：EVLR与VLR存储内容类似，但是允许存储更长的额外信息，并且附加在数据记录之后。<br>关于LAS文件格式的更多信息，可以参考LAS 1.4的<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2008.06972">标准文件</a>。</li>
</ul>
<h3 id="LASzip文件格式"><a href="#LASzip文件格式" class="headerlink" title="LASzip文件格式"></a>LASzip文件格式</h3><p>LASzip对于LAS文件头，VLR，EVLR不进行任何压缩，直接拷贝这些字段；只对数据记录段进行压缩。v1.4版本LAS文件与之前版本相比增加了多种点云数据格式，也就是类型6到类型10。针对v1.4版本LAS标准变化，LASzip也在听取了诸多开源社区建议之后，对v1.4版本LAS文件的压缩做出了相应改进。对于类型0-5的类型，文件格式和压缩方法与v1.0到v1.3版本的LAS压缩方法一致，不再叙述。使用类型6到10的点格式，v1.4版本的LAS文件使用最新的LASzip软件压缩后，.laz文件的典型结构如下：</p>
<ol>
<li>LAS文件头</li>
<li>VLRs + LASzip VLR</li>
<li>n个数据块（chunk）<ol>
<li>块1</li>
<li>块2</li>
<li>块3<br>…<br>块n</li>
</ol>
</li>
<li>数据块表（块开始地址和点数量）</li>
<li>EVLRs</li>
<li>LASindex EVLR（用于未来实现更快的空间索引和查询）</li>
<li>LASlayers EVLR（用于在文件中原地编辑点的分类和标识位）</li>
</ol>
<p>数据块结构如下：</p>
<ol>
<li>原始点</li>
<li>数量和字节数<ul>
<li>剩余点数</li>
<li>每个层的字节数</li>
</ul>
</li>
<li>数据记录层<ul>
<li>扫描通道、点来源变化、 GPS时间变化、扫描角度变化、返回计数、XY 层</li>
<li>Z 层</li>
<li>分类层</li>
<li>标志位层</li>
<li>强度层</li>
<li>扫描角度层</li>
<li>用户数据层</li>
<li>点来源ID层<br>可选的：</li>
<li>RGB层</li>
<li>NIR层</li>
<li>波形包层</li>
<li>额外字节层<br>与v1.0到v1.3版本的LAS文件压缩之后的格式相比，v1.4版本的.laz文件有两个主要变化：</li>
</ul>
</li>
<li>数据块的大小可变；</li>
<li>每个数据块里按照不同字段分层编码。</li>
</ol>
<h3 id="LASzip压缩算法"><a href="#LASzip压缩算法" class="headerlink" title="LASzip压缩算法"></a>LASzip压缩算法</h3><p>LAS v1.4定义了0 - 10共11种点的类型，其中0-5型继承自v1.0 - v1.3版本，6-10型为v1.4新增类型。LASzip压缩器将不同点格式视作几种“成分”的组合。0-5型点格式由POINT10, GPSTIME10, RGB12, WAVEPACKET13和BYTE五种成分的不同组合表示。详见下表：<br><img src="https://i.loli.net/2021/04/06/k1WGRbCUqxOt3g5.png" alt="类型0-5的组成"><br>6至10型的点由不同成分组成的“数据层”的组合表示。类型6至10的组成详见下表：<br><img src="https://i.loli.net/2021/04/07/9HS2rGt4KfvwIYM.png" alt="LAS v1.4类型6-10点"></p>
<p>对每种数据LASzip设计了不同的压缩器。由不同成分组成的不同类型点可以复用这些压缩器，实现模块化复用。在每个数据块的开始，LASzip存储了第一个点的原始数据，并且初始化编码器。该点的数据用来作为后续预测的初值，之后每个点的数值全部依次进行编码。<br>LASzip采用了基于自适应的基于上下文的算术编码器对数值进行差分编码。对于每种不同的成分，采用不同策略进行压缩，追求最高的压缩率。详情可以参考文献。</p>
<h2 id="LASzip压缩测试"><a href="#LASzip压缩测试" class="headerlink" title="LASzip压缩测试"></a>LASzip压缩测试</h2><h3 id="测试数据准备"><a href="#测试数据准备" class="headerlink" title="测试数据准备"></a>测试数据准备</h3><p>测试数据来自于众包地图构建中生成的一些道路点云数据集。数据集格式是二进制编码的pcd文件，在后续测试中，pcd格式文件的大小也是压缩率的基准。在本次测试中，一共准备了8组测试数据。</p>
<h3 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h3><ul>
<li>压缩倍率测试：<ol>
<li>使用LASzip和zip对pcd文件进行编码，分别记录编码后文件的大小。</li>
<li>重复步骤1，多次测量，分别记录不同编码算法编码前后文件大小。</li>
<li>计算原始pcd文件大小之和，编码之后.laz文件大小之和，编码之后.zip文件大小之和。</li>
<li>根据公式“压缩倍率 = 原始文件大小 / 压缩后文件大小”计算多种编码方法的平均压缩率。</li>
</ol>
</li>
<li>编码速度测试：<ol>
<li>使用PDAL库的writers.las模块测试.las、.laz文件的编码速度。</li>
<li>重复步骤1，对每一个数据pcd文件进行编码，记录所用时间。</li>
<li>根据公式“编码速度 = 模型点数/编码耗时”计算平均编码速度。</li>
</ol>
</li>
<li>解码速度测试：<ol>
<li>对编码速度测试中生成的.las、.laz文件使用PDAL进行解码。</li>
<li>重复步骤1，对每一个文件解码，并计算总时间。</li>
<li>根据公式“解码速度 = 模型点数/解码耗时”计算平均解码速度。</li>
</ol>
</li>
</ul>
<h3 id="测试结论"><a href="#测试结论" class="headerlink" title="测试结论"></a>测试结论</h3><p>本文对LASzip的压缩性能进行了一些测试，下表对LASzip压缩测试结果进行了总结。</p>
<table>
<thead>
<tr>
<th>项目</th>
<th>PCD</th>
<th>LAS</th>
<th>LASzip</th>
<th>GZIP</th>
</tr>
</thead>
<tbody><tr>
<td>平均压缩倍率（源文件大小/压缩后文件大小）</td>
<td>1.0</td>
<td>0.42</td>
<td>4.61</td>
<td>1.52</td>
</tr>
<tr>
<td>编码+输出文件速度（万点/秒）</td>
<td>-</td>
<td>21.3</td>
<td>17.8</td>
<td>-</td>
</tr>
<tr>
<td>解码速度（万点/秒）</td>
<td>-</td>
<td>-</td>
<td>51.8</td>
<td>-</td>
</tr>
<tr>
<td>点云存储效率</td>
<td>0.900</td>
<td>2.119</td>
<td>0.195</td>
<td>-</td>
</tr>
<tr>
<td>LICENSE</td>
<td>BSD</td>
<td>LGPL</td>
<td>LGPL</td>
<td>zlib license</td>
</tr>
<tr>
<td>LIBRARY</td>
<td>PCL</td>
<td>PDAL Libels</td>
<td>Laszip Pylaz</td>
<td>zlib</td>
</tr>
</tbody></table>
<p>根据表格中的结果，可以得到以下结论：</p>
<ol>
<li>LASzip压缩算法的压缩倍率确实远高于通用压缩算法。</li>
<li>LASzip编解码器的速度很快，可以满足自动驾驶的实时性要求。</li>
</ol>
<h2 id="LASzip项目集成"><a href="#LASzip项目集成" class="headerlink" title="LASzip项目集成"></a>LASzip项目集成</h2><p>总的来说，LASzip具有压缩倍率高，无损，编解码速度快，受到业界广泛支持等优点，特别适用于高精地图和众包地图业务。在众包地图业务中，已经集成了LASzip作为点云存储格式。目前，比较流行的LASzip编解码库主要是LASzip，lazperf, 和PDAL。下面对这三种库进行比较。</p>
<ul>
<li>LASzip：LASzip是rapidlasso Gmbh.官方出品的LASzip参考实现，使用c编码，对LASzip压缩算法的支持是最全面和可靠的，软件无专利限制，采用LGPL License，易于集成。</li>
<li>lazperf：lazperf是开源组织Hobu实现的LASzip替代编解码库。该库的实现采用C++编码，面向对象模式开发，更加直观简洁，据称在某些情况下性能更好。不过该库只能支持1.3之前版本的LASzip编解码，并且已经不再维护了。</li>
<li>PDAL：PDAL是主要由Hobu维护的一个点云数据抽象层库，采用LGPL授权，功能更加全面，远不止LASzip编解码功能，定位类似于适量和标量地图领域的GDAL。PDAL支持多种主流点云格式的编解码，点云的滤波等处理。PDAL对LASzip的支持也是通过封装LASzip库实现。相比c实现的LASzip库，功能更加全面，接口更加简洁。<br>以上三个库都可以用于编解码LASzip，下表对他们的特性进行了一个总结。</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>LASzip</th>
<th>Lazperf</th>
<th>PDAL</th>
</tr>
</thead>
<tbody><tr>
<td>License</td>
<td>LGPL</td>
<td>LGPL</td>
<td>LGPL</td>
</tr>
<tr>
<td>支持LASzip v1.4</td>
<td>是</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>语言</td>
<td>c</td>
<td>c++</td>
<td>c++</td>
</tr>
<tr>
<td>编码</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>解码</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>复杂功能</td>
<td>否</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>依赖其他第三方软件</td>
<td>否</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>是否符合车规</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
</tbody></table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="http://gaochangyu.github.com/2016/08/30/SimpleLight-Project/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="常宇">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="麦田博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/08/30/SimpleLight-Project/" class="post-title-link" itemprop="url">SimpleLight Project</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-08-30 10:18:00" itemprop="dateCreated datePublished" datetime="2016-08-30T10:18:00+08:00">2016-08-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-03 16:44:33" itemprop="dateModified" datetime="2021-04-03T16:44:33+08:00">2021-04-03</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2016/08/30/SimpleLight-Project/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/08/30/SimpleLight-Project/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>SimpleLight is a project I participate in Turku University. It’s an easy-to-use, web based remote control LED lamp.  </p>
<h1 id="Simple-Light-Project"><a href="#Simple-Light-Project" class="headerlink" title="Simple Light Project"></a><a href="#Simple-Light-Project" title="Simple Light Project"></a><a target="_blank" rel="noopener" href="https://github.com/gaochangyu/SimpleLight">Simple Light Project</a></h1><p>Programmer: Gao Changyu, Qian Jiayan, Yang Xuerui<br><img src="https://i.loli.net/2021/04/03/t4r5FCNQEybZpLY.jpg" alt="simplelightdemo"></p>
<h2 id="Hardware"><a href="#Hardware" class="headerlink" title="Hardware"></a><a href="#Hardware" title="Hardware"></a>Hardware</h2><p>The hardware is quite simple. We got 4 adafruit neopixel(ws2812b) led and connect them serially. The data in port is connected to pin 18, vcc and gnd are connected directly to raspberry pi.</p>
<h2 id="Setup-software-for-raspberry-pi-2B"><a href="#Setup-software-for-raspberry-pi-2B" class="headerlink" title="Setup software for raspberry pi 2B"></a><a href="#Setup-software-for-raspberry-pi-2B" title="Setup software for raspberry pi 2B"></a>Setup software for raspberry pi 2B</h2><p>The project is configured for raspberry pi 2B. Before running the code, you need to install some dependencies.</p>
<ol>
<li>Install the newest raspbian image to a SD card. In our case, we use raspbian jessie.</li>
<li>Connect the raspberry pi to the Internet with a cable. Log into the board with ssh.</li>
<li>follow the instruction in (<a target="_blank" rel="noopener" href="http://www.fernandocosentino.net/pyoconnect/">http://www.fernandocosentino.net/pyoconnect/</a>) to install dependencies for PyoConnect 1.0.</li>
<li>In the terminal, run the following commands to install other dependencies. $ sudo apt-get update<br> $ sudo apt-get install git cmake nodejs mysql-server-5.5 libmysqlcppconn-dev python-mysqldb<br> -y  </li>
</ol>
<p>when asked the root password of mysql, use 123456.</p>
<ol>
<li>configure the database: $ mysql -uroot -p<br> mysql&gt; create database lightcontrol<br> mysql&gt; use lightcontrol<br> mysql&gt; source ~/light_control_project/sql/database.sql  </li>
<li>get the source code: $ cd ~<br> $ git clone <a target="_blank" rel="noopener" href="https://github.com/gaochangyu/SimpleLight.git">https://github.com/gaochangyu/SimpleLight.git</a>  </li>
<li>make the ws2812b_controller: $ cd ~/light_control_project/ws2812b_controller/<br> $ cmake .<br> $ make  </li>
</ol>
<h2 id="Run-the-software"><a href="#Run-the-software" class="headerlink" title="Run the software"></a><a href="#Run-the-software" title="Run the software"></a>Run the software</h2><p>run the ws2812b controller:  </p>
<p>$ sudo ~/light_control_project/ws2812b_controller/ws2812b_raspberry_pi2  </p>
<p>run the webpage server:  </p>
<p>$ nodejs ~/light_control_project/server/SimpleLight.nodejs  </p>
<p>run the Myo Connect adapter:  </p>
<p>$ python ~/light_control_project/PyoConnect_v1.0/light_control.pyoc  </p>
<h2 id="Enjoy-it"><a href="#Enjoy-it" class="headerlink" title="Enjoy it!"></a><a href="#Enjoy-it" title="Enjoy it!"></a>Enjoy it!</h2><p>Connect raspberry pi to a router, then you can access the webpage at <a target="_blank" rel="noopener" href="http://ip_of_raspberry_pi:3000/">http://ip_of_raspberry_pi:3000</a>. You should be able to change the light color of the leds through a palette (in mode one).<br>Myo connect is also supported. you can use double click gesture to change the visual effect.</p>
<ul>
<li>  mode 1: Rainbow Effect.</li>
<li>  mode 2: Flash Effect.</li>
<li>  mode 3: Flashing Rainbow Effect.</li>
<li>  mode 4: Change the led color with the web palette.</li>
</ul>
<h2 id="Docs"><a href="#Docs" class="headerlink" title="Docs"></a><a href="#Docs" title="Docs"></a>Docs</h2><p>All the documents about the project are in Docs folder.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="http://gaochangyu.github.com/2016/05/26/class-diagram-learning-journal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="常宇">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="麦田博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/05/26/class-diagram-learning-journal/" class="post-title-link" itemprop="url">class diagram learning journal</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-05-26 22:50:00" itemprop="dateCreated datePublished" datetime="2016-05-26T22:50:00+08:00">2016-05-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-03 16:44:38" itemprop="dateModified" datetime="2021-04-03T16:44:38+08:00">2021-04-03</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2016/05/26/class-diagram-learning-journal/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/26/class-diagram-learning-journal/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>a learning journal about class diagram.  </p>
<p>I found a very useful website on this topic:<a target="_blank" rel="noopener" href="https://dzone.com/articles/uml2-class-diagram-java">reference</a>.<br>Basically, now I know the meaning of different connections:</p>
<ul>
<li>  solid line with arrow: assosiation, means the static relationship between two classes along with the multiplicity.</li>
<li>  solid line with triangle head: the inheritance feature of the object oriented concept. In Java this can relate to the “extends” keyword.</li>
<li>  dotted line with arrow: Dependency is a relationship that shows that a class is dependent on another class for its existence or implementation.</li>
<li>  dotted line with triangle head: This is related to the relationship between the class and the interface. The realization is equivalent to the “implements” keyword in Java.</li>
<li>  solid line with hollow diamond: This shows “has a” relationship. It is a form of association relationship. This relationship highlights that a whole is made of its parts.So if a whole is destroyed the part still remains.</li>
<li>  solid line with filled diamond: This is again a whole or part relationship where if the whole is destroyed then the part cannot exist independently. Another important point about Composition is that the part at any point in time can have only one owner.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="http://gaochangyu.github.com/2016/05/04/work%20diary%20of%20capstone%20project/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="常宇">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="麦田博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/05/04/work%20diary%20of%20capstone%20project/" class="post-title-link" itemprop="url">work diary of capstone project</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-05-04 19:50:00" itemprop="dateCreated datePublished" datetime="2016-05-04T19:50:00+08:00">2016-05-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-03 16:44:34" itemprop="dateModified" datetime="2021-04-03T16:44:34+08:00">2021-04-03</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2016/05/04/work%20diary%20of%20capstone%20project/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/04/work diary of capstone project/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>  <a href="/tags/capstone/">capstone</a></li>
</ul>
<p>In this blog, I will record the working progress in the capstone project and the problems I faced.  </p>
<h1 id="23-10-2016"><a href="#23-10-2016" class="headerlink" title="23.10.2016"></a><a href="#23-10-2016" title="23.10.2016"></a>23.10.2016</h1><ul>
<li>changed the default hover controller. add three new actions PX4TakeoffAction, PX4LandAction and PX4 FlytoAction.<h1 id="30-9-2016"><a href="#30-9-2016" class="headerlink" title="  30.9.2016"></a>  <a href="#30-9-2016" title="30.9.2016"></a>30.9.2016</h1></li>
<li>  in statemachine, use file io to read a flight script.</li>
<li>in statemachine, timeout failure would be trigered if a state takes too long time.<h1 id="28-9-2016"><a href="#28-9-2016" class="headerlink" title="  28.9.2016"></a>  <a href="#28-9-2016" title="28.9.2016"></a>28.9.2016</h1></li>
<li>modified the mode in states to OFFBOARD to match with PX4.<h1 id="5-9-2016"><a href="#5-9-2016" class="headerlink" title="  5.9.2016"></a>  <a href="#5-9-2016" title="5.9.2016"></a>5.9.2016</h1>  Hover_Controller:<br>  Cablibrate the P I D and achieved better control. Proved that the controller structure is ok. But I still need to improve the controller structure itself.<h1 id="4-9-2016"><a href="#4-9-2016" class="headerlink" title="  4.9.2016"></a>  <a href="#4-9-2016" title="4.9.2016"></a>4.9.2016</h1>  for the hover controller:</li>
<li>  remove unnecessary files</li>
<li>  rewrite the waypoint navigation logic</li>
<li>try to calibrate PID parameters but strange things always happen and the result gets even worse.<h1 id="26-8-2016"><a href="#26-8-2016" class="headerlink" title="  26.8.2016"></a>  <a href="#26-8-2016" title="26.8.2016"></a>26.8.2016</h1></li>
<li>update the state machine and hover controller, now a simulation is achived but quite ugly.<h1 id="24-8-2016"><a href="#24-8-2016" class="headerlink" title="  24.8.2016"></a>  <a href="#24-8-2016" title="24.8.2016"></a>24.8.2016</h1></li>
<li>update the state machine<h1 id="7-8-2016"><a href="#7-8-2016" class="headerlink" title="  7.8.2016"></a>  <a href="#7-8-2016" title="7.8.2016"></a>7.8.2016</h1>  hover_controller: in gazebo simulation environment, the hover controller is now able to control a single drone to take off, land and navigate through the way point.<h1 id="7-6-2016"><a href="#7-6-2016" class="headerlink" title="  7.6.2016"></a>  <a href="#7-6-2016" title="7.6.2016"></a>7.6.2016</h1></li>
<li>fix state machine compiling problem<h1 id="4-6-2016-7-6-2016"><a href="#4-6-2016-7-6-2016" class="headerlink" title="  4.6.2016 - 7.6.2016"></a>  <a href="#4-6-2016-7-6-2016" title="4.6.2016 - 7.6.2016"></a>4.6.2016 - 7.6.2016</h1></li>
<li>based on an APM FCU firmware, I started to code a position controller which is able to controll the quadcopter to takeoff ,land and fly through preset waypoints.<h1 id="28-5-2016"><a href="#28-5-2016" class="headerlink" title="  28.5.2016"></a>  <a href="#28-5-2016" title="28.5.2016"></a>28.5.2016</h1>  mavlink streaming</li>
</ul>
<hr>
<p>Working Content: Today I tested the mavlink steaming rate of miniAPM. The original APM3.2.1 firmware support up to 25 Hz of message streaming. This is limited by the software, So I modified the firmware and successfully increased the rate to 50Hz. In fact the rate can be improved to up to 100 Hz. But I’m afraid this will harm the stability of the firmware.<br>In ArduCopter.pde, The scheduler update rate of gcs_data_stream_send() is set to 50Hz. This function is the regarding to the streaming of message. The function is in GCS_Mavlink.pde.  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> \*  </span><br><span class="line"> \*  send data streams in the given rate range on both links  </span><br><span class="line"> \*</span><br><span class="line">static void gcs\_data\_stream\_send(void)  </span><br><span class="line">&#123;  </span><br><span class="line"> for (uint8\_t i&#x3D;0; i&lt;num\_gcs; i++) &#123;  </span><br><span class="line"> if (gcs\[i\].initialised) &#123;  </span><br><span class="line"> gcs\[i\].data\_stream\_send();  </span><br><span class="line"> &#125;   </span><br><span class="line"> &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>In this function data_stream_send() is called, each stream is sent based on the following statement.  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(stream\_triger(STREAM\_RAW\_SENSORS)) &#123;  </span><br><span class="line"> send\_message(MSG\_RAW\_IMU1);  </span><br><span class="line"> send\_message(MSG\_RAW\_IMU2);  </span><br><span class="line"> send\_message(MSG\_RAW\_IMU3);  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<p>The limit occurs in stream_triger(), as shown below:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">if (stream\_ticks\[stream\_num\] &#x3D;&#x3D; 0) &#123;  </span><br><span class="line"> &#x2F;&#x2F; we&#39;re triggering now, setup the next trigger point  </span><br><span class="line"> if (rate &gt; 50) &#123;  </span><br><span class="line"> rate &#x3D; 50;  </span><br><span class="line"> &#125;else if(rate &gt; 25)&#123;  </span><br><span class="line"> stream\_ticks\[stream\_num\] &#x3D; 0 + stream\_slowdown;  </span><br><span class="line"> &#125;else &#123;  </span><br><span class="line"> stream\_ticks\[stream\_num\] &#x3D; (50 &#x2F; rate) + stream\_slowdown;  </span><br><span class="line"> &#125;   </span><br><span class="line"> return true;  </span><br><span class="line">&#125;  </span><br><span class="line">&#x2F;&#x2F; count down at 50Hz  </span><br><span class="line">stream\_ticks\[stream\_num\]--;  </span><br><span class="line">return false;  </span><br></pre></td></tr></table></figure>

<p>This is already my modified version. The stream_ticks is count down at 50 Hz. So when rate &gt; 25, the streaming rate can not increase any more. So when rate &gt; 25, I set the stream_ticks[stream_num] to 0, so they rate will go up to 50 Hz.<br>Time: 3 hour.</p>
<h2 id="off-board-switch"><a href="#off-board-switch" class="headerlink" title="off board switch"></a><a href="#off-board-switch" title="off board switch"></a>off board switch</h2><p>Working Content: I figured out how every channel is used in Arducopter. channel 1 ~ channel 4 are used for throttle, roll, pitch, yaw. channel 5 is used for mode switch. channel 6 is optionally used for tuning and camera. channel 7 and above are aux switch for more functions. I think I can add a new auxilary function to switch on and off off-board mode. and connect the receiver’s channel 6 to channel 7. then we can use channel 6 on transmitter to toggle off-board.</p>
<h1 id="24-5-2016"><a href="#24-5-2016" class="headerlink" title="24.5.2016"></a><a href="#24-5-2016" title="24.5.2016"></a>24.5.2016</h1><p>Working Content: I modified the pixy node and add a ros publisher. It doesn’t work at first with rosrun. Latter I found in the official guide of installation that I need to copy the /src/host/linux/pixy.ruls to /etc/udev/ruls.d <a target="_blank" rel="noopener" href="http://http//cmucam.org/projects/cmucam5/wiki/Installing_PixyMon_on_Linux">reference</a>.<br>Time: 1 hour.</p>
<h1 id="19-5-2016"><a href="#19-5-2016" class="headerlink" title="19.5.2016"></a><a href="#19-5-2016" title="19.5.2016"></a>19.5.2016</h1><p>Working Content: I finally found the way to upgrade the firmware of the miniAPM. Before I tried to use the mission planner to upgrade the miniAPM but the transmission always fail. Today I downloaded an APM Planner to my mac and succesfully upgraded miniAPM to arducopter 3.2.1. In this version “arming” through mavlink is implemented. More over when the mavlink connection is down, the control will fail over to transmitter when RC_OVERRIDE is used. That’s also a good news.<br>Today I also modified the firmware source code of ArduCopter. I’m trying to enhance the failsafe feature in RC_OVERRIDE. I will enhance the code based on the orignal Arducopter 3.2.1 because that’s the newest firmware supported by miniAPM.<br>Time: 3 hours.</p>
<h1 id="4-5-2016"><a href="#4-5-2016" class="headerlink" title="4.5.2016"></a><a href="#4-5-2016" title="4.5.2016"></a>4.5.2016</h1><p>Working Content: I tested the mavros arming service to arm the apm. It doesn’t work. But I don’t think it’s a bug of mavros. The mission planner cannot arm the apm neither.<br>I also tested the rcoverride function of mavros. It worked. The SYSID_MYGCS param of apm must be set to 1, so that the mavros can override the rc. But I found that once you use the rcoverride to take over the transmitter, you cannot use the transmitter to take over the mavros again. This would cause problem when I want to use the transmitter to take over the raspberry pi in emergency.<br>Improved the pan tilt control of pixy.<br>Time: 5 hours.</p>
<h1 id="3-5-2016"><a href="#3-5-2016" class="headerlink" title="3.5.2016"></a><a href="#3-5-2016" title="3.5.2016"></a>3.5.2016</h1><p>Working Content: Calibrate the lens distortion (radial and tangental distortion) of the pixy camera. We used the <a target="_blank" rel="noopener" href="http://docs.opencv.org/2.4/doc/tutorials/calib3d/camera_calibration/camera_calibration.html">camera_calibration sample code of opencv 2.4.9</a> to calculate the camera matrix and distortion coefficients. The focus length of pixy camera is adjustable, so every time I adjust the focus length I need to re-calibrate the camera. It’s not convinient.<br>We use the following equations to calibrate the distortion:<br><img src="http://docs.opencv.org/2.4/_images/math/5e4f3162fa216cb82d4f85628c64398dc7b57e5d.png" alt="alt text"><br><img src="http://docs.opencv.org/2.4/_images/math/63e4830dd6b39017395767d53114379d973a7268.png" alt="alt text"><br>The calibrated result is acceptable but not accurate. Because we are not sure the meaning of x, y and r. I’m afraid there are some mistakes in not calculation.<br>Time: 5 hours.</p>
<h1 id="2-5-2016"><a href="#2-5-2016" class="headerlink" title="2.5.2016"></a><a href="#2-5-2016" title="2.5.2016"></a>2.5.2016</h1><p>Working Content: Assembly and test fly the drone.<br>Time: 5 hours.</p>
<h1 id="29-4-2016"><a href="#29-4-2016" class="headerlink" title="29.4.2016"></a><a href="#29-4-2016" title="29.4.2016"></a>29.4.2016</h1><p>Working Content: Assembly the drone.<br>Time: 5 hours.</p>
<h1 id="28-4-2016"><a href="#28-4-2016" class="headerlink" title="28.4.2016"></a><a href="#28-4-2016" title="28.4.2016"></a>28.4.2016</h1><p>Working Content: Assembly the drone; Change the color marker recognition method from four different colors to two different colors.<br>Time : 5 houts.</p>
<h1 id="8-4-2016"><a href="#8-4-2016" class="headerlink" title="8.4.2016"></a><a href="#8-4-2016" title="8.4.2016"></a>8.4.2016</h1><p>Working Content: update the CMakeList.txt of pixy_node. fix the compiling failure.<br>Time: 3 hours.</p>
<h1 id="5-4-2016"><a href="#5-4-2016" class="headerlink" title="5.4.2016"></a><a href="#5-4-2016" title="5.4.2016"></a>5.4.2016</h1><p>Working Content: Checkout the mavros and mavlink submodule. fix the conflict of the submodules.<br>Time: 4 hours.</p>
<h1 id="27-2-2016"><a href="#27-2-2016" class="headerlink" title="27.2.2016"></a><a href="#27-2-2016" title="27.2.2016"></a>27.2.2016</h1><p>Working Content: Improve the simulation environment. The apm sitl firmware is not realistic, and we would like to use PX4 autopilot stack. So I compiled the px4 sitl firmware on linux and upgrade gazebo to version 6.0.<br>Time :8 hours.</p>
<h1 id="17-2-2016"><a href="#17-2-2016" class="headerlink" title="17.2.2016"></a><a href="#17-2-2016" title="17.2.2016"></a>17.2.2016</h1><p>Working Content: Set up the simulation environment in linux. The simulation environment includes the apm sitl firmware, the ros and gazebo simulation environment. I tested the simulation and it works.<br>Time: 8 hours.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="http://gaochangyu.github.com/2016/02/17/How-to-setup-ardupilot-simulation-environment-in-Ubuntu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="常宇">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="麦田博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/02/17/How-to-setup-ardupilot-simulation-environment-in-Ubuntu/" class="post-title-link" itemprop="url">How to setup ardupilot simulation environment in Ubuntu</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-02-17 10:25:00" itemprop="dateCreated datePublished" datetime="2016-02-17T10:25:00+08:00">2016-02-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-03 16:44:31" itemprop="dateModified" datetime="2021-04-03T16:44:31+08:00">2021-04-03</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2016/02/17/How-to-setup-ardupilot-simulation-environment-in-Ubuntu/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/02/17/How-to-setup-ardupilot-simulation-environment-in-Ubuntu/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ROS is a popular and useful software framework in robotics area. Gazebo is a powerful robotic simulator. Ardupilot provide a tutorial for sitl simulation in ROS/Gazebo environment. I tried to setup this environment in my mac. Here I share the record of my steps.  </p>
<h1 id="Set-up-ROS-Gazebo-APM-SITL-environment-on-Ubuntu"><a href="#Set-up-ROS-Gazebo-APM-SITL-environment-on-Ubuntu" class="headerlink" title="Set up ROS Gazebo APM SITL environment on Ubuntu"></a><a href="#Set-up-ROS-Gazebo-APM-SITL-environment-on-Ubuntu" title="Set up ROS Gazebo APM SITL environment on Ubuntu"></a>Set up ROS Gazebo APM SITL environment on Ubuntu</h1><p><strong><em>Install Ubuntu 14.04.3</em></strong></p>
<ol>
<li> Download Ubuntu 14.04.3 64bit desktop edition image from ubuntu.com</li>
<li> Install the system in virtual machine or as second operating system</li>
<li> Set the username as developer and password as 12345678</li>
</ol>
<h2 id="Clone-ardupilot-source"><a href="#Clone-ardupilot-source" class="headerlink" title="Clone ardupilot source"></a><a href="#Clone-ardupilot-source" title="Clone ardupilot source"></a>Clone ardupilot source</h2><ol>
<li> open terminal in ubuntu</li>
<li> run <code>sudo apt-get install git</code></li>
<li> make a directory:<code>mkdir workspace</code></li>
<li> enter the workspace: <code>cd workspace</code></li>
<li> clone the source from github:<code>git clone https://github.com/alexbuyval/ardupilot</code></li>
<li> cd ardupilot directory and check out RangeFinderSITL2:<code>cd ardupilot</code></li>
<li> <code>git checkout RangeFinderSITL2</code></li>
</ol>
<h2 id="Install-ROS"><a href="#Install-ROS" class="headerlink" title="Install ROS"></a><a href="#Install-ROS" title="Install ROS"></a>Install ROS</h2><ol>
<li> <code>sudo sh -c &#39;echo &quot;deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list&#39;</code></li>
<li> <code>sudo apt-key adv --keyserver hkp://pool.sks-keyservers.net --recv-key 0xB01FA116</code></li>
<li> <code>sudo apt-get update</code></li>
<li> <code>sudo apt-get install ros-indigo-desktop-full</code></li>
<li> <code>sudo rosdep init</code></li>
<li> <code>rosdep update</code></li>
<li> <code>echo &quot;source /opt/ros/indigo/setup.bash&quot; &gt;&gt; ~/.bashrc</code></li>
<li> <code>source ~/.bashrc</code></li>
<li> <code>sudo apt-get install python-rosinstall</code></li>
</ol>
<h2 id="Create-ROS-Workspace"><a href="#Create-ROS-Workspace" class="headerlink" title="Create ROS Workspace"></a><a href="#Create-ROS-Workspace" title="Create ROS Workspace"></a>Create ROS Workspace</h2><ol>
<li> <code>mkdir -p ~/catkin_ws/src</code></li>
<li> <code>cd ~/catkin_ws/src</code></li>
<li> <code>catkin_init_workspace</code></li>
<li> <code>cd ~/catkin_ws/</code></li>
<li> <code>catkin_make</code></li>
<li> <code>echo &quot;source $HOME/catkin_ws/devel/setup.bash&quot; &gt;&gt; ~/.bashrc</code></li>
<li> <code>source ~/.bashrc</code></li>
<li> <code>echo $ROS_PACKAGE_PATH</code></li>
<li> if you can see the following message, it’s successful:<code>/home/developer/catkin_ws/src:/opt/ros/indigo/share:/opt/ros/indigo/stacks</code></li>
</ol>
<h2 id="Clone-Install-ROS-package"><a href="#Clone-Install-ROS-package" class="headerlink" title="Clone/Install ROS package"></a><a href="#Clone-Install-ROS-package" title="Clone/Install ROS package"></a>Clone/Install ROS package</h2><ol>
<li><code>sudo apt-get install ros-indigo-octomap-msgs</code><br> 2.<pre><code> roscd
 cd ../src #Navigate in your ROS user source files directory
 git clone https://[email protected]/alexbuyval/arducopter_sitl_ros.git
 git clone https://github.com/PX4/mav_comm.git
 git clone https://github.com/alexbuyval/rotors_simulator.git
 git clone https://github.com/ros-drivers/joystick_drivers.git
 git clone https://github.com/ethz-asl/glog_catkin.git
 git clone https://github.com/catkin/catkin_simple.git
 git clone https://github.com/ethz-asl/gflags_catkin.git
 cd rotors_simulator
 git checkout sonar_plugin
 cd ../..
 wstool init src
 wstool set -t src mavros --git https://github.com/alexbuyval/mavros.git
 wstool update -t src
 rosdep install --from-paths src --ignore-src --rosdistro indigo -y
 
</code></pre>
</li>
<li> compile the packages:<code>roscd</code></li>
<li> <code>cd ..</code></li>
<li> <code>catkin_make</code></li>
<li> if the catkin-make failed bacause the lack of gawk, run <code>sudo apt-get install gawk</code></li>
<li> setup PATH: <code>echo &#39;PATH=&quot;$PATH:/home/developer/workspace/ardupilot/Tools/autotest&quot;&#39; &gt;&gt; ~/.profile</code></li>
</ol>
<h2 id="Install-necessary-python-package"><a href="#Install-necessary-python-package" class="headerlink" title="Install necessary python package"></a><a href="#Install-necessary-python-package" title="Install necessary python package"></a>Install necessary python package</h2><ol>
<li> <code>sudo apt-get install python-pip</code></li>
<li> <code>sudo pip install pymavlink</code></li>
</ol>
<h2 id="Run-the-simulation"><a href="#Run-the-simulation" class="headerlink" title="Run the simulation"></a><a href="#Run-the-simulation" title="Run the simulation"></a>Run the simulation</h2><ol>
<li> <code>cd ~/workspace/ardupilot/ArduCopter</code></li>
<li> <code>sim_vehicle.sh -f arducopter_sitl_ros --console</code></li>
</ol>
<h2 id="The-simulation-view"><a href="#The-simulation-view" class="headerlink" title="The simulation view"></a><a href="#The-simulation-view" title="The simulation view"></a>The simulation view</h2><p><img src="https://i.loli.net/2021/04/03/ldeQAbDUOFWpZkv.png" alt="screen_shot" title="If the environment is set properly, you can see this"></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><a href="#Reference" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="http://dev.ardupilot.com/wiki/using-rosgazebo-simulator-with-sitl/">Using ROS/Gazebo Simulator with SITL</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">常宇</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">常宇</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://gaochangyu-github-io.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>

</body>
</html>
